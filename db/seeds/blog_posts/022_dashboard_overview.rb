# 記事22: ダッシュボードで一目でわかる営業状況
blog_post_22 = BlogPost.find_or_create_by!(public_id: 'dashboard-overview-2026') do |post|
  post.title = "ダッシュボードで一目でわかる営業状況"
  post.summary = "ホーム画面をダッシュボードに刷新。問い合わせ数、商談状況、媒体分析など、営業活動に必要な情報をKPIカードとグラフで可視化しました。"
  post.content = <<~'MARKDOWN'
## なぜダッシュボードが必要だったのか

これまでのホーム画面は、各機能へのメニューが並ぶシンプルな構成でした。

> 「朝、出社したらまず何を確認すればいいんだろう？」
> 「未対応の問い合わせって今いくつあるっけ？」
> 「今月の反響数、先月より多い？少ない？」

こうした疑問に答えるために、**ダッシュボード**を実装しました。ログインしてすぐ、営業状況が把握できます。

## ダッシュボードの構成

### KPIカード（画面上部）

4つの重要指標を大きなカードで表示します。

| カード | 内容 |
|--------|------|
| 今月の問い合わせ | 件数と前月比（%） |
| 進行中の案件 | 未対応・対応中の合計 |
| アクティブな顧客 | 商談中の顧客数 |
| 公開中のページ | 公開ページ数 |

```jsx
<SummaryCard
  title="今月の問い合わせ"
  value={summary.inquiries.count}
  subValue={`前月比 ${summary.inquiries.change_percentage}%`}
  icon={<EmailIcon />}
/>
```

前月比がプラスなら緑、マイナスなら赤で表示。一目で傾向が分かります。

### 問い合わせトレンド（折れ線グラフ）

過去30日間の問い合わせ数を日別で表示。

```jsx
<LineChart data={trendData}>
  <Line
    type="monotone"
    dataKey="count"
    stroke="#1976d2"
    strokeWidth={2}
  />
  <Tooltip />
</LineChart>
```

週末に問い合わせが増える傾向や、特定の日に急増したタイミングなど、パターンが見えてきます。

### 商談ステータス分布（ドーナツチャート）

顧客の商談ステータスを円グラフで可視化。

- 新規反響
- 対応中
- 内見予約
- 内見済
- 申込
- 成約
- 失注

どの段階に顧客が多いか、パイプラインの健全性が一目で分かります。

### 媒体別問い合わせ（横棒グラフ）

今月の問い合わせを媒体別に集計。

```jsx
<BarChart data={mediaData} layout="vertical">
  <Bar dataKey="count" fill="#1976d2" />
  <XAxis type="number" />
  <YAxis dataKey="name" type="category" />
</BarChart>
```

SUUMO、at home、自社HP、LINEなど、どの媒体からの反響が多いか把握できます。広告費の配分を検討する際の参考になります。

### 未対応案件リスト

ステータスが「未対応」の問い合わせを最新10件表示。

- 物件名
- 顧客名
- 経過日数
- 媒体

経過日数が多いものほど目立つように表示。クリックすると顧客詳細画面に遷移し、すぐに対応を開始できます。

### 最近のアクティビティ

直近の対応履歴を5件表示。

- 誰が
- どの顧客に
- 何をしたか
- いつ

チームメンバーの活動が見えるので、対応の重複を防げます。

### 要対応アラート

注意が必要な項目を赤で強調表示。

- **優先度「高」「緊急」の顧客** - すぐに対応が必要
- **アクセス期限が7日以内** - 顧客向け公開ページの期限切れ間近

## 技術的なこだわり

### 1回のAPIコールでデータ取得

ダッシュボードに必要な全データを1回のAPIコールで取得します。

```ruby
# app/controllers/api/v1/dashboards_controller.rb
def show
  render json: {
    summary: build_summary,
    inquiry_trend: build_inquiry_trend,
    deal_status_distribution: build_deal_status_distribution,
    media_breakdown: build_media_breakdown,
    pending_inquiries: build_pending_inquiries,
    recent_activities: build_recent_activities,
    alerts: build_alerts
  }
end
```

複数回のAPIコールを避けることで、表示速度を最適化しています。

### Rechartsによるグラフ描画

グラフ描画には[Recharts](https://recharts.org/)を採用しました。

- React向けに設計されたライブラリ
- SVGベースで軽量
- レスポンシブ対応が容易
- カスタマイズ性が高い

### レスポンシブレイアウト

画面サイズに応じてレイアウトが変化します。

| 画面サイズ | KPIカード | グラフ | リスト |
|-----------|----------|--------|--------|
| スマホ | 2×2 | 1列 | 1列 |
| タブレット | 4×1 | 2列 | 2列 |
| PC | 4×1 | 2列 | 3列 |

外出先でもスマホで状況確認ができます。

## 実際の使われ方

### 朝のルーティン

1. ログイン → ダッシュボードを確認
2. 未対応案件をチェック
3. 経過日数が長いものから順に対応
4. アラートの「優先度高」を確認

### 週次ミーティング

1. 問い合わせトレンドを画面共有
2. 媒体別の反響を確認
3. 商談ステータス分布で進捗把握
4. アクセス期限切れの顧客をフォロー

### 月次レポート作成

1. 今月の問い合わせ数を確認
2. 前月比でトレンドを把握
3. 媒体別の効果を分析
4. 成約数を確認

## ヘッダーの改善

今回のアップデートでは、ヘッダーメニューも整理しました。

### 「ホーム」リンクの削除

ロゴをクリックすればホームに戻れるため、冗長な「ホーム」リンクを削除。メニューをすっきりさせました。

### 「物件管理」にアイコン追加

他のメニュー項目と統一感を持たせるため、地図アイコンを追加しました。

```jsx
const menuItems = [
  { to: "/map", label: "物件管理", icon: <MapIcon fontSize="small" /> },
  // ...
];
```

## まとめ

**ログインしたら、まずダッシュボード**。

- 今月の反響数と前月比がすぐ分かる
- 未対応案件が一覧で見える
- 媒体別の効果が可視化される
- 優先度の高い顧客を見逃さない

「何から手をつければいいか分からない」という迷いがなくなり、効率的な営業活動が可能になります。

ダッシュボードのデータをさらに活用するため、今後はカスタマイズ機能やレポート出力機能も検討しています。お楽しみに。
  MARKDOWN
  post.status = :published
  post.published_at = Time.zone.parse('2026-01-12 12:00:00')
  post.commit_hash = '39c2d9d'
end

puts "✓ 記事作成: #{blog_post_22.title}"
