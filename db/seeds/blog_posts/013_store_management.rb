# 記事13: 店舗管理機能
blog_post_13 = BlogPost.find_or_create_by!(public_id: 'store-management-2025') do |post|
  post.title = "複数店舗の物件を一元管理！店舗管理機能"
  post.summary = "店舗マスタを登録し、物件を店舗ごとに管理・絞り込みできる店舗管理機能をリリースしました。"
  post.content = <<~'MARKDOWN'
## 複数店舗を展開する会社の課題

不動産会社が複数の店舗を展開している場合、こんな課題はありませんか？

- 「A店の物件とB店の物件が混在して、管理しにくい」
- 「他店の物件を間違えてお客様に紹介してしまった」
- 「店舗ごとの物件数や成約状況を把握したい」

CoCoスモの**店舗管理機能**で、これらの課題を解決できます。

## 店舗管理機能とは

会社内の**店舗（支店・営業所）をマスタ登録**し、物件と紐付けて管理できる機能です。

- 店舗ごとに物件を絞り込み
- 店舗の位置を地図上に表示
- 店舗別の集計・分析

## 設定の流れ

### Step 1: 店舗マスタを登録

管理画面から店舗情報を登録します。

- **店舗名**: 「恵比寿店」「渋谷店」など
- **住所**: 店舗の所在地
- **電話番号**: 店舗の連絡先
- **座標**: 住所から自動取得（ジオコーディング）

```ruby
# ジオコーディング処理
class Store < ApplicationRecord
  before_save :geocode_address

  def geocode_address
    return if address.blank?

    result = Geocoder.search(address).first
    if result
      self.latitude = result.latitude
      self.longitude = result.longitude
    end
  end
end
```

### Step 2: 物件に店舗を紐付け

物件（建物）の登録・編集画面で、担当店舗を選択します。

### Step 3: 店舗で絞り込み

地図画面や物件一覧画面で、店舗を選択して絞り込み。自分の店舗の物件だけを表示できます。

## 機能詳細

### 店舗の地図表示

地図上に店舗の位置がアイコンで表示されます。

初回アクセス時は、店舗の位置を中心に地図が表示されるので、すぐに周辺物件を確認できます。

### 店舗別フィルター

左パネルの検索条件に「店舗」を追加。

- 全店舗
- 恵比寿店
- 渋谷店
- 代官山店

ワンクリックで切り替えられます。

### 検索前提条件

「この店舗の物件だけを常に表示したい」という場合は、検索前提条件に店舗を設定。

毎回フィルターを選択する手間が省けます。

### 店舗別集計

店舗ごとの物件数、空室数、成約率などを集計・比較できます。

## 活用シーン

### 店舗間の情報共有

他店舗の物件情報も閲覧可能。お客様の希望エリアに応じて、他店舗の物件を紹介できます。

### 店舗別の業績管理

店舗ごとの物件数、成約数を把握。営業戦略の立案に活用できます。

### 新店舗オープン時

新店舗を登録し、担当エリアの物件を紐付け。スムーズに業務を開始できます。

## 権限管理（今後の展望）

現在は全店舗の物件を閲覧できますが、今後は権限管理機能を追加予定です。

- 自店舗の物件のみ閲覧/編集可能
- 他店舗の物件は閲覧のみ
- 本部は全店舗の物件を管理

店舗規模や運用に合わせて、柔軟に設定できるようになります。

## まとめ

店舗管理機能を使えば、**複数店舗の物件を一元管理**できます。

- 店舗マスタを登録し、物件と紐付け
- 店舗ごとに物件を絞り込み・集計
- 地図上に店舗位置を表示

複数店舗を展開する不動産会社様、ぜひご活用ください。
  MARKDOWN
  post.status = :published
  post.published_at = Time.zone.parse('2025-12-19 10:00:00')
  post.commit_hash = 'd205773'
end

puts "✓ 記事作成: #{blog_post_13.title}"
