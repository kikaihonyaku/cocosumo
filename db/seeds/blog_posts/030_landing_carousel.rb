# 記事30: ランディングページに機能紹介カルーセルとデモスライドショーを追加
blog_post_30 = BlogPost.find_or_create_by!(public_id: 'landing-carousel-2026') do |post|
  post.title = "ランディングページを刷新 — 機能紹介カルーセルとアプリ画面スライドショーを実装"
  post.summary = "Embla Carouselを使い、ランディングページに2つのスライドショーを追加しました。ヒーローセクションにはアプリのスクリーンショットを、デモセクションには6つの主要機能をビジュアルで紹介するカルーセルを実装しています。"
  post.content = <<~'MARKDOWN'
## はじめに — 「準備中」のままだったデモセクション

CoCoスモのランディングページには、以前からデモセクションが設置されていました。しかし、その中身はというと…

```
┌──────────────────────────────┐
│  🖼  スクリーンショットまたはデモ動画  │
│         準備中                    │
└──────────────────────────────┘
```

> 「せっかくランディングページを見に来てくれた方に、アプリの魅力が伝わっていない」

画面右側のモック表示も再生ボタン風のプレースホルダーのままで、実際に何ができるサービスなのかが伝わりませんでした。今回、この2つのセクションを本格的なインタラクティブコンテンツに刷新しました。

## 2つのスライドショーで「体験」を届ける

### ヒーローセクション: アプリ画面スライドショー

ページを開いて最初に目に入るヒーローセクション。ここにアプリの実際の画面キャプチャをスライドショーで表示するようにしました。

```
┌──────────────────────────────────┐
│ ● ● ●   ダッシュボード               │
├──────────────────────────────────┤
│                                    │
│   [アプリの実際の画面キャプチャ]        │
│                                    │
├──────────────────────────────────┤
│          ● ○ ○ ○ ○                 │
└──────────────────────────────────┘
```

ブラウザ風のフレーム（赤・黄・緑のウィンドウボタン）を維持しつつ、タイトルバーには現在表示中の画面名を動的に表示。3秒間隔で自動スライドし、マウスホバーで一時停止します。

表示される画面は以下の5つです。

| スライド | 画面 | 見どころ |
|---------|------|---------|
| 1 | ダッシュボード | 問い合わせトレンドや商談ステータスの一覧 |
| 2 | GISマップシステム | Google Maps連携の物件地図管理 |
| 3 | 建物詳細（物件情報） | 地図・基本情報・部屋一覧の統合表示 |
| 4 | 建物詳細（写真付き） | 外観写真やGoogleマップ連携 |
| 5 | 部屋詳細 | 募集図面・VRツアー・バーチャルステージング |

### デモセクション: 機能紹介カルーセル

「準備中」だったデモセクションは、6つの主要機能をビジュアルで紹介するカルーセルに生まれ変わりました。

```
┌────────────────────────────────────────┐
│  Feature 1/6                             │
│                     ┌─────────────────┐ │
│  物件管理            │                 │ │
│                     │   🏢  アイコン   │ │
│  建物・部屋情報を     │                 │ │
│  Googleマップ連携の   └─────────────────┘ │
│  GISシステムで一元管理                     │
│                                          │
│  ◀  ────────────────────────────── ▶    │
│           ━━ ○ ○ ○ ○ ○                  │
└────────────────────────────────────────┘
```

各スライドは機能ごとに異なるグラデーション背景を持ち、左にテキスト説明、右にアイコンビジュアルを配置。5秒間隔の自動再生に加え、左右矢印ボタンとドットインジケーターで手動操作も可能です。モバイルでは縦並びに自動切り替えされます。

## 技術的なこだわり

### Embla Carousel を採用した理由

カルーセルライブラリの選定では、いくつかの選択肢を検討しました。

| ライブラリ | バンドルサイズ | React対応 | 選定理由 |
|-----------|-------------|----------|---------|
| Swiper | 〜140KB | ○ | 高機能だがサイズ大 |
| Slick | 〜40KB | △（ラッパー必要） | メンテナンス停滞 |
| **Embla Carousel** | **〜12KB** | **◎（公式Hook）** | **軽量・柔軟・活発** |

Embla Carouselは公式の `embla-carousel-react` フックを提供しており、Reactとの親和性が高いのが決め手でした。自動再生は `embla-carousel-autoplay` プラグインで追加します。

```jsx
import useEmblaCarousel from "embla-carousel-react";
import Autoplay from "embla-carousel-autoplay";

function DemoSlideshow() {
  const [emblaRef, emblaApi] = useEmblaCarousel(
    { loop: true },
    [Autoplay({ delay: 3000, stopOnInteraction: false, stopOnMouseEnter: true })]
  );

  return (
    <div className="overflow-hidden" ref={emblaRef}>
      <div className="flex">
        {screenshots.map((shot, i) => (
          <div key={i} className="flex-[0_0_100%] min-w-0">
            <img src={shot.src} alt={shot.label} />
          </div>
        ))}
      </div>
    </div>
  );
}
```

`useEmblaCarousel` にプラグイン配列を渡すだけで自動再生が有効になります。`stopOnMouseEnter: true` を指定しているので、ユーザーがカルーセルにマウスを乗せると自動再生が一時停止し、じっくり画面を見ることができます。

### ドットインジケーターのデザイン

アクティブなドットは幅が広がるアニメーションで、現在のスライド位置を直感的に伝えます。

```jsx
<button
  className={`w-2.5 h-2.5 rounded-full transition-all duration-300 ${
    index === selectedIndex
      ? "bg-[#c9a227] w-8"   // アクティブ: ゴールドに拡大
      : "bg-gray-300 hover:bg-gray-400"
  }`}
/>
```

CoCoスモのブランドカラー（ネイビー `#1e3a5f` とゴールド `#c9a227`）を一貫して使い、サイト全体のデザインの統一感を保っています。

### Puppeteerによるスクリーンショット自動キャプチャ

スクリーンショットの手動撮影は面倒で、更新のたびに忘れがちです。そこで、Puppeteerを使ったスクリーンショットの自動キャプチャスクリプトも作成しました。

```javascript
// scripts/capture-screenshots.mjs
const browser = await puppeteer.launch({
  executablePath: "/usr/bin/chromium",
  headless: true,
});

// API経由でログイン（セッションクッキーを取得）
const loginResult = await page.evaluate(async (creds) => {
  const res = await fetch("/api/v1/auth/login", {
    method: "POST",
    headers: { "Content-Type": "application/json" },
    body: JSON.stringify(creds),
  });
  return { status: res.status, body: await res.json() };
}, CREDENTIALS);

// 各ページを巡回してキャプチャ
for (const pageInfo of PAGES) {
  await page.goto(`${BASE_URL}${pageInfo.path}`);
  await page.screenshot({ path: outputPath });
}
```

ポイントは**ログイン方法**です。CoCoスモはMUIのTextFieldを使っており、Puppeteerの `page.type()` ではReactのstate更新がトリガーされません。そこで、ブラウザ内でfetch APIを直接呼び出してセッションを確立する方式を採用しました。

また、マルチテナント環境ではサブドメインによるテナント識別が必要なため、`sample.lvh.me:3000`（`lvh.me` は `127.0.0.1` に解決される開発用ドメイン）経由でアクセスしています。

```bash
# スクリーンショット更新コマンド
node scripts/capture-screenshots.mjs
```

アプリに新しい画面が追加されたときも、スクリプトの `PAGES` 配列に追記して実行するだけで、ランディングページのスライドショーが最新のキャプチャに更新されます。

## レスポンシブ対応

両方のカルーセルは、画面サイズに応じたレイアウト調整を行っています。

```
デスクトップ: [テキスト ← | → アイコン]  横並び
モバイル:     [テキスト]
              [アイコン]               縦並び
```

機能紹介カルーセルのアイコンはデスクトップで3倍、モバイルで2.5倍にスケールし、どのデバイスでも適切なサイズで表示されます。矢印ボタンもデスクトップではカルーセルの外側に、モバイルでは内側に配置を変えています。

## まとめ

今回の実装で、ランディングページが「情報を並べただけ」から「体験を伝える」ページに進化しました。

- **ヒーローセクション**: プレースホルダーから実際のアプリ画面スライドショーに
- **デモセクション**: 「準備中」から6機能のビジュアル紹介カルーセルに
- **自動更新**: Puppeteerスクリプトでスクリーンショットの更新を自動化
- **軽量実装**: Embla Carousel（約12KB）で高機能なカルーセルを実現

ランディングページは、多くの方がCoCoスモに触れる最初の接点です。「このサービスは何ができるんだろう？」と思った方に、言葉だけでなく画面の動きで魅力を感じてもらえるようになりました。今後はスクリーンショットの種類を増やし、VRツアーのプレビューやAI画像生成のBefore/Afterなども組み込んでいく予定です。
  MARKDOWN
  post.status = :published
  post.published_at = Time.zone.parse('2026-02-01 18:00:00')
  post.commit_hash = 'bf0ba8a'
end

puts "✓ 記事作成: #{blog_post_30.title}"
